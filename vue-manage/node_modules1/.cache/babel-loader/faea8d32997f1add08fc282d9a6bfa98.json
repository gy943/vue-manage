{"ast":null,"code":"import CommonForm from '../../src/components/CommonForm.vue';\nimport CommonTable from '../../src/components/CommonTable.vue';\nimport { getUser } from '../../api/data.js';\nexport default {\n  name: 'User',\n  components: {\n    CommonForm,\n    CommonTable\n  },\n\n  data() {\n    return {\n      operateType: 'add',\n      isShow: false,\n      opertateFormLabel: [{\n        model: 'name',\n        label: '姓名',\n        type: 'input'\n      }, {\n        model: 'age',\n        label: '年龄',\n        type: 'input'\n      }, {\n        model: 'sex',\n        label: '性别',\n        type: 'select',\n        opts: [{\n          label: '男',\n          value: 1\n        }, {\n          label: '女',\n          value: 0\n        }]\n      }, {\n        model: 'birth',\n        label: '出生日期',\n        type: 'date'\n      }, {\n        model: 'addr',\n        label: '地址',\n        type: 'input'\n      }],\n      operateForm: {\n        name: '',\n        addr: '',\n        age: '',\n        birth: '',\n        sex: ''\n      },\n      formLabel: [{\n        model: \"keyword\",\n        label: '',\n        type: 'input'\n      }],\n      searchFrom: {\n        keyword: ''\n      },\n      tableData: [],\n      tableLabel: [{\n        prop: \"name\",\n        label: \"姓名\"\n      }, {\n        prop: \"age\",\n        label: \"年龄\"\n      }, {\n        prop: \"sexLabel\",\n        label: \"性别\"\n      }, {\n        prop: \"birth\",\n        label: \"出生日期\",\n        width: 200\n      }, {\n        prop: \"addr\",\n        label: \"地址\",\n        width: 320\n      }],\n      config: {\n        page: 1,\n        total: 30\n      }\n    };\n  },\n\n  methods: {\n    confirm() {\n      if (this.operateType === 'edit') {\n        this.$http.post('/user/edit', this.operateForm).then(res => {\n          console.log(res);\n          this.isShow = false;\n          this.getList();\n        });\n      } else {\n        this.$http.post('/user/add', this.operateForm).then(res => {\n          console.log(res);\n          this.isShow = false;\n          this.getList();\n        });\n      }\n    },\n\n    addUser() {\n      this.isShow = true;\n      this.operateType = 'add';\n      this.operateForm = {\n        name: '',\n        addr: '',\n        age: '',\n        birth: '',\n        sex: ''\n      };\n    },\n\n    editUser(row) {\n      this.operateType = 'edit';\n      this.isShow = true;\n      this.operateForm = row;\n    },\n\n    delUser(row) {\n      this.$confirm(\"此操作将永久删除该文件, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确认\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        const id = row.id;\n        this.$http.post(\"/user/del\", {\n          params: {\n            id\n          }\n        }).then(() => {\n          this.$message({\n            type: 'success',\n            message: '删除成功'\n          });\n          this.getList();\n        });\n      });\n    },\n\n    getList(name = '') {\n      this.config.loading = true;\n      name ? this.config.page = 1 : '';\n      getUser({\n        page: this.config.page,\n        name\n      }).then(({\n        data: res\n      }) => {\n        console.log(res, 'res');\n        this.tableData = res.list.map(item => {\n          item.sexLabel = item.sex === 0 ? \"女\" : \"男\";\n          return item;\n        });\n        this.config.total = res.count;\n        this.config.loading = false;\n      });\n    }\n\n  },\n\n  created() {\n    // 在生命周期里调用\n    this.getList();\n  }\n\n};","map":{"version":3,"mappings":"AA2CA;AACA;AACA;AACA;EACAA,YADA;EAEAC;IACAC,UADA;IAEAC;EAFA,CAFA;;EAMAC;IACA;MACAC,kBADA;MAEAC,aAFA;MAGAC,oBACA;QACAC,aADA;QAEAC,WAFA;QAGAC;MAHA,CADA,EAMA;QACAF,YADA;QAEAC,WAFA;QAGAC;MAHA,CANA,EAWA;QACAF,YADA;QAEAC,WAFA;QAGAC,cAHA;QAIAC,OACA;UACAF,UADA;UAEAG;QAFA,CADA,EAKA;UACAH,UADA;UAEAG;QAFA,CALA;MAJA,CAXA,EA0BA;QACAJ,cADA;QAEAC,aAFA;QAGAC;MAHA,CA1BA,EA+BA;QACAF,aADA;QAEAC,WAFA;QAGAC;MAHA,CA/BA,CAHA;MAwCAG;QACAb,QADA;QAEAc,QAFA;QAGAC,OAHA;QAIAC,SAJA;QAKAC;MALA,CAxCA;MA+CAC,YACA;QACAV,gBADA;QAEAC,SAFA;QAGAC;MAHA,CADA,CA/CA;MAsDAS;QACAC;MADA,CAtDA;MAyDAC,aAzDA;MA0DAC,aACA;QACAC,YADA;QAEAd;MAFA,CADA,EAKA;QACAc,WADA;QAEAd;MAFA,CALA,EASA;QACAc,gBADA;QAEAd;MAFA,CATA,EAaA;QACAc,aADA;QAEAd,aAFA;QAGAe;MAHA,CAbA,EAkBA;QACAD,YADA;QAEAd,WAFA;QAGAe;MAHA,CAlBA,CA1DA;MAkFAC;QACAC,OADA;QAEAC;MAFA;IAlFA;EAuFA,CA9FA;;EA+FAC;IACAC;MACA;QACA;UACAC;UACA;UACA;QACA,CAJA;MAKA,CANA,MAMA;QACA;UACAA;UACA;UACA;QACA,CAJA;MAKA;IACA,CAfA;;IAgBAC;MACA;MACA;MACA;QACA/B,QADA;QAEAc,QAFA;QAGAC,OAHA;QAIAC,SAJA;QAKAC;MALA;IAOA,CA1BA;;IA2BAe;MACA;MACA;MACA;IACA,CA/BA;;IAgCAC;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAzB;MAHA,GAIA0B,IAJA,CAIA;QACA;QACA;UACAC;YAAAC;UAAA;QADA,GAEAF,IAFA,CAEA;UACA;YACA1B,eADA;YAEA6B;UAFA;UAIA;QACA,CARA;MASA,CAfA;IAgBA,CAjDA;;IAkDAC;MACA;MACAxC;MACAyC;QACAf,sBADA;QAEA1B;MAFA,GAGAoC,IAHA,CAGA;QAAAhC;MAAA;QACA0B;QACA;UACAY;UACA;QACA,CAHA;QAIA;QACA;MACA,CAXA;IAYA;;EAjEA,CA/FA;;EAkKAC;IACA;IACA;EACA;;AArKA","names":["name","components","CommonForm","CommonTable","data","operateType","isShow","opertateFormLabel","model","label","type","opts","value","operateForm","addr","age","birth","sex","formLabel","searchFrom","keyword","tableData","tableLabel","prop","width","config","page","total","methods","confirm","console","addUser","editUser","delUser","confirmButtonText","cancelButtonText","then","params","id","message","getList","getUser","item","created"],"sourceRoot":"views/User","sources":["index.vue"],"sourcesContent":["<template>\r\n    <div class=\"manage\">\r\n        <div v-if=\"isShow\"><el-dialog :title=\"operateType==='add'? '新增用户':'更新用户'\" :visible.sync=\"isShow\">\r\n            <common-form \r\n            :formLabel=\"opertateFormLabel\" \r\n            :form=\"operateForm\" \r\n            :inline=\"true\" \r\n            ref=\"form\">\r\n            </common-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"isShow=false\">取消</el-button>\r\n                <el-button type=\"primary\" @click=\"confirm\" >确定</el-button>\r\n            </div>\r\n        </el-dialog></div>\r\n        \r\n        <div class=\"manage-header\">\r\n           \r\n             <el-button type=\"primary\" @click=\"addUser\">+新增</el-button>\r\n            \r\n             <common-form \r\n            :formLabel=\"formLabel\" \r\n            :form=\"searchForm\" \r\n            :inline=\"true\" \r\n            ref=\"form\">\r\n\r\n            <el-button type=\"primary\" @click=\"getList\">搜索</el-button>\r\n\r\n            </common-form>\r\n             \r\n        </div>\r\n       <common-table \r\n       :tableData=\"tableData\"\r\n       :tableLabel=\"tableLabel\"\r\n       :config=\"config\"\r\n       :@changePage=\"getList()\"\r\n       @edit=\"editUser\"\r\n       @del=\"delUser\">\r\n\r\n       </common-table>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport CommonForm from '../../src/components/CommonForm.vue'\r\nimport CommonTable from '../../src/components/CommonTable.vue'\r\nimport {getUser} from '../../api/data.js'\r\nexport default {\r\n    name: 'User',\r\n    components: {\r\n        CommonForm,\r\n        CommonTable\r\n    },\r\n    data() {\r\n        return {\r\n            operateType: 'add',\r\n            isShow: false,\r\n            opertateFormLabel: [\r\n                {\r\n                    model: 'name',\r\n                    label: '姓名',\r\n                    type: 'input'\r\n                },\r\n                {\r\n                    model: 'age',\r\n                    label: '年龄',\r\n                    type: 'input'\r\n                },\r\n                {\r\n                    model: 'sex',\r\n                    label: '性别',\r\n                    type: 'select',\r\n                    opts: [\r\n                        {\r\n                            label: '男',\r\n                            value: 1\r\n                        },\r\n                        {\r\n                            label: '女',\r\n                            value: 0\r\n                        }\r\n                    ]\r\n                },\r\n                {\r\n                    model: 'birth',\r\n                    label: '出生日期',\r\n                    type: 'date'\r\n                },\r\n                {\r\n                    model: 'addr',\r\n                    label: '地址',\r\n                    type: 'input'\r\n                }\r\n            ],\r\n            operateForm: {\r\n                name: '',\r\n                addr: '',\r\n                age: '',\r\n                birth: '',\r\n                sex: ''\r\n            },\r\n            formLabel: [\r\n                {\r\n                    model: \"keyword\",\r\n                    label: '',\r\n                    type: 'input'\r\n                }\r\n            ],\r\n            searchFrom: {\r\n                keyword: ''\r\n            },\r\n            tableData: [],\r\n            tableLabel: [\r\n                {\r\n                    prop: \"name\",\r\n                    label: \"姓名\"\r\n                },\r\n                {\r\n                    prop: \"age\",\r\n                    label: \"年龄\"\r\n                },\r\n                {\r\n                    prop: \"sexLabel\",\r\n                    label: \"性别\"\r\n                },\r\n                {\r\n                    prop: \"birth\",\r\n                    label: \"出生日期\",\r\n                    width: 200\r\n                },\r\n                {\r\n                    prop: \"addr\",\r\n                    label: \"地址\",\r\n                    width: 320\r\n                }\r\n            ],\r\n            config: {\r\n                page: 1,\r\n                total: 30\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        confirm() {\r\n            if (this.operateType === 'edit') {\r\n                this.$http.post('/user/edit', this.operateForm).then(res => {\r\n                    console.log(res)\r\n                    this.isShow = false\r\n                    this.getList()\r\n                })\r\n            } else {\r\n                this.$http.post('/user/add', this.operateForm).then(res => {\r\n                    console.log(res)\r\n                    this.isShow = false\r\n                    this.getList()\r\n                })\r\n            }\r\n        },\r\n        addUser() {\r\n            this.isShow = true\r\n            this.operateType = 'add'\r\n            this.operateForm = {\r\n                name: '',\r\n                addr: '',\r\n                age: '',\r\n                birth: '',\r\n                sex: ''\r\n            }\r\n        },\r\n        editUser(row) {\r\n            this.operateType = 'edit'\r\n            this.isShow = true\r\n            this.operateForm = row\r\n        },\r\n        delUser(row) {\r\n            this.$confirm(\"此操作将永久删除该文件, 是否继续?\", \"提示\", {\r\n                confirmButtonText: \"确认\",\r\n                cancelButtonText: \"取消\",\r\n                type: \"warning\"\r\n            }).then(() => {\r\n                const id = row.id\r\n                this.$http.post(\"/user/del\", {\r\n                    params: { id }\r\n                }).then(() => {\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '删除成功'\r\n                    })\r\n                    this.getList()\r\n                })\r\n            })\r\n        },\r\n        getList(name = '') {\r\n            this.config.loading = true\r\n            name ? (this.config.page = 1) : ''\r\n            getUser({\r\n                page: this.config.page,\r\n                name\r\n            }).then(({ data: res }) => {\r\n                console.log(res, 'res')\r\n                this.tableData = res.list.map(item => {\r\n                    item.sexLabel = item.sex === 0 ? \"女\" : \"男\"\r\n                    return item\r\n                })\r\n                this.config.total = res.count\r\n                this.config.loading = false\r\n            })\r\n        }\r\n    },\r\n    created() {\r\n        // 在生命周期里调用\r\n        this.getList()\r\n    }\r\n}\r\n        \r\n\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n\r\n\r\n\r\n.manage-header{\r\ndisplay:flex;\r\njustify-content:space-between;\r\nalign-items:center;\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}