{"ast":null,"code":"import { createElement } from '../core';\nimport * as zrUtil from '../../core/util';\nimport Path from '../../graphic/Path';\nimport ZRImage from '../../graphic/Image';\nimport TSpan from '../../graphic/TSpan';\nimport { path as svgPath, image as svgImage, text as svgText } from '../graphic';\nvar MARK_UNUSED = '0';\nvar MARK_USED = '1';\n\nvar Definable = function () {\n  function Definable(zrId, svgRoot, tagNames, markLabel, domName) {\n    this.nextId = 0;\n    this._domName = '_dom';\n    this.createElement = createElement;\n    this._zrId = zrId;\n    this._svgRoot = svgRoot;\n    this._tagNames = typeof tagNames === 'string' ? [tagNames] : tagNames;\n    this._markLabel = markLabel;\n\n    if (domName) {\n      this._domName = domName;\n    }\n  }\n\n  Definable.prototype.getDefs = function (isForceCreating) {\n    var svgRoot = this._svgRoot;\n\n    var defs = this._svgRoot.getElementsByTagName('defs');\n\n    if (defs.length === 0) {\n      if (isForceCreating) {\n        var defs_1 = svgRoot.insertBefore(this.createElement('defs'), svgRoot.firstChild);\n\n        if (!defs_1.contains) {\n          defs_1.contains = function (el) {\n            var children = defs_1.children;\n\n            if (!children) {\n              return false;\n            }\n\n            for (var i = children.length - 1; i >= 0; --i) {\n              if (children[i] === el) {\n                return true;\n              }\n            }\n\n            return false;\n          };\n        }\n\n        return defs_1;\n      } else {\n        return null;\n      }\n    } else {\n      return defs[0];\n    }\n  };\n\n  Definable.prototype.doUpdate = function (target, onUpdate) {\n    if (!target) {\n      return;\n    }\n\n    var defs = this.getDefs(false);\n\n    if (target[this._domName] && defs.contains(target[this._domName])) {\n      if (typeof onUpdate === 'function') {\n        onUpdate(target);\n      }\n    } else {\n      var dom = this.add(target);\n\n      if (dom) {\n        target[this._domName] = dom;\n      }\n    }\n  };\n\n  Definable.prototype.add = function (target) {\n    return null;\n  };\n\n  Definable.prototype.addDom = function (dom) {\n    var defs = this.getDefs(true);\n\n    if (dom.parentNode !== defs) {\n      defs.appendChild(dom);\n    }\n  };\n\n  Definable.prototype.removeDom = function (target) {\n    var defs = this.getDefs(false);\n\n    if (defs && target[this._domName]) {\n      defs.removeChild(target[this._domName]);\n      target[this._domName] = null;\n    }\n  };\n\n  Definable.prototype.getDoms = function () {\n    var defs = this.getDefs(false);\n\n    if (!defs) {\n      return [];\n    }\n\n    var doms = [];\n    zrUtil.each(this._tagNames, function (tagName) {\n      var tags = defs.getElementsByTagName(tagName);\n\n      for (var i = 0; i < tags.length; i++) {\n        doms.push(tags[i]);\n      }\n    });\n    return doms;\n  };\n\n  Definable.prototype.markAllUnused = function () {\n    var doms = this.getDoms();\n    var that = this;\n    zrUtil.each(doms, function (dom) {\n      dom[that._markLabel] = MARK_UNUSED;\n    });\n  };\n\n  Definable.prototype.markDomUsed = function (dom) {\n    dom && (dom[this._markLabel] = MARK_USED);\n  };\n\n  ;\n\n  Definable.prototype.markDomUnused = function (dom) {\n    dom && (dom[this._markLabel] = MARK_UNUSED);\n  };\n\n  ;\n\n  Definable.prototype.isDomUnused = function (dom) {\n    return dom && dom[this._markLabel] !== MARK_USED;\n  };\n\n  Definable.prototype.removeUnused = function () {\n    var _this = this;\n\n    var defs = this.getDefs(false);\n\n    if (!defs) {\n      return;\n    }\n\n    var doms = this.getDoms();\n    zrUtil.each(doms, function (dom) {\n      if (_this.isDomUnused(dom)) {\n        defs.removeChild(dom);\n      }\n    });\n  };\n\n  Definable.prototype.getSvgProxy = function (displayable) {\n    if (displayable instanceof Path) {\n      return svgPath;\n    } else if (displayable instanceof ZRImage) {\n      return svgImage;\n    } else if (displayable instanceof TSpan) {\n      return svgText;\n    } else {\n      return svgPath;\n    }\n  };\n\n  Definable.prototype.getSvgElement = function (displayable) {\n    return displayable.__svgEl;\n  };\n\n  return Definable;\n}();\n\nexport default Definable;","map":{"version":3,"names":["createElement","zrUtil","Path","ZRImage","TSpan","path","svgPath","image","svgImage","text","svgText","MARK_UNUSED","MARK_USED","Definable","zrId","svgRoot","tagNames","markLabel","domName","nextId","_domName","_zrId","_svgRoot","_tagNames","_markLabel","prototype","getDefs","isForceCreating","defs","getElementsByTagName","length","defs_1","insertBefore","firstChild","contains","el","children","i","doUpdate","target","onUpdate","dom","add","addDom","parentNode","appendChild","removeDom","removeChild","getDoms","doms","each","tagName","tags","push","markAllUnused","that","markDomUsed","markDomUnused","isDomUnused","removeUnused","_this","getSvgProxy","displayable","getSvgElement","__svgEl"],"sources":["E:/school/qianduan/web/vue-manage/node_modules/zrender/lib/svg/helper/Definable.js"],"sourcesContent":["import { createElement } from '../core';\nimport * as zrUtil from '../../core/util';\nimport Path from '../../graphic/Path';\nimport ZRImage from '../../graphic/Image';\nimport TSpan from '../../graphic/TSpan';\nimport { path as svgPath, image as svgImage, text as svgText } from '../graphic';\nvar MARK_UNUSED = '0';\nvar MARK_USED = '1';\nvar Definable = (function () {\n    function Definable(zrId, svgRoot, tagNames, markLabel, domName) {\n        this.nextId = 0;\n        this._domName = '_dom';\n        this.createElement = createElement;\n        this._zrId = zrId;\n        this._svgRoot = svgRoot;\n        this._tagNames = typeof tagNames === 'string' ? [tagNames] : tagNames;\n        this._markLabel = markLabel;\n        if (domName) {\n            this._domName = domName;\n        }\n    }\n    Definable.prototype.getDefs = function (isForceCreating) {\n        var svgRoot = this._svgRoot;\n        var defs = this._svgRoot.getElementsByTagName('defs');\n        if (defs.length === 0) {\n            if (isForceCreating) {\n                var defs_1 = svgRoot.insertBefore(this.createElement('defs'), svgRoot.firstChild);\n                if (!defs_1.contains) {\n                    defs_1.contains = function (el) {\n                        var children = defs_1.children;\n                        if (!children) {\n                            return false;\n                        }\n                        for (var i = children.length - 1; i >= 0; --i) {\n                            if (children[i] === el) {\n                                return true;\n                            }\n                        }\n                        return false;\n                    };\n                }\n                return defs_1;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return defs[0];\n        }\n    };\n    Definable.prototype.doUpdate = function (target, onUpdate) {\n        if (!target) {\n            return;\n        }\n        var defs = this.getDefs(false);\n        if (target[this._domName] && defs.contains(target[this._domName])) {\n            if (typeof onUpdate === 'function') {\n                onUpdate(target);\n            }\n        }\n        else {\n            var dom = this.add(target);\n            if (dom) {\n                target[this._domName] = dom;\n            }\n        }\n    };\n    Definable.prototype.add = function (target) {\n        return null;\n    };\n    Definable.prototype.addDom = function (dom) {\n        var defs = this.getDefs(true);\n        if (dom.parentNode !== defs) {\n            defs.appendChild(dom);\n        }\n    };\n    Definable.prototype.removeDom = function (target) {\n        var defs = this.getDefs(false);\n        if (defs && target[this._domName]) {\n            defs.removeChild(target[this._domName]);\n            target[this._domName] = null;\n        }\n    };\n    Definable.prototype.getDoms = function () {\n        var defs = this.getDefs(false);\n        if (!defs) {\n            return [];\n        }\n        var doms = [];\n        zrUtil.each(this._tagNames, function (tagName) {\n            var tags = defs.getElementsByTagName(tagName);\n            for (var i = 0; i < tags.length; i++) {\n                doms.push(tags[i]);\n            }\n        });\n        return doms;\n    };\n    Definable.prototype.markAllUnused = function () {\n        var doms = this.getDoms();\n        var that = this;\n        zrUtil.each(doms, function (dom) {\n            dom[that._markLabel] = MARK_UNUSED;\n        });\n    };\n    Definable.prototype.markDomUsed = function (dom) {\n        dom && (dom[this._markLabel] = MARK_USED);\n    };\n    ;\n    Definable.prototype.markDomUnused = function (dom) {\n        dom && (dom[this._markLabel] = MARK_UNUSED);\n    };\n    ;\n    Definable.prototype.isDomUnused = function (dom) {\n        return dom && dom[this._markLabel] !== MARK_USED;\n    };\n    Definable.prototype.removeUnused = function () {\n        var _this = this;\n        var defs = this.getDefs(false);\n        if (!defs) {\n            return;\n        }\n        var doms = this.getDoms();\n        zrUtil.each(doms, function (dom) {\n            if (_this.isDomUnused(dom)) {\n                defs.removeChild(dom);\n            }\n        });\n    };\n    Definable.prototype.getSvgProxy = function (displayable) {\n        if (displayable instanceof Path) {\n            return svgPath;\n        }\n        else if (displayable instanceof ZRImage) {\n            return svgImage;\n        }\n        else if (displayable instanceof TSpan) {\n            return svgText;\n        }\n        else {\n            return svgPath;\n        }\n    };\n    Definable.prototype.getSvgElement = function (displayable) {\n        return displayable.__svgEl;\n    };\n    return Definable;\n}());\nexport default Definable;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}