{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { each, isString, createHashMap } from 'zrender/lib/core/util';\nimport parseGeoJson from './parseGeoJson'; // Built-in GEO fixer.\n\nimport fixNanhai from './fix/nanhai';\nimport fixTextCoord from './fix/textCoord';\nimport fixGeoCoord from './fix/geoCoord';\nimport fixDiaoyuIsland from './fix/diaoyuIsland';\nimport BoundingRect from 'zrender/lib/core/BoundingRect';\nvar DEFAULT_NAME_PROPERTY = 'name';\n\nvar GeoJSONResource =\n/** @class */\nfunction () {\n  function GeoJSONResource(mapName, geoJSON, specialAreas) {\n    this.type = 'geoJSON';\n    this._parsedMap = createHashMap();\n    this._mapName = mapName;\n    this._specialAreas = specialAreas; // PENDING: delay the parse to the first usage to rapid up the FMP?\n\n    this._geoJSON = parseInput(geoJSON);\n  }\n  /**\n   * @param nameMap can be null/undefined\n   * @param nameProperty can be null/undefined\n   */\n\n\n  GeoJSONResource.prototype.load = function (nameMap, nameProperty) {\n    nameProperty = nameProperty || DEFAULT_NAME_PROPERTY;\n\n    var parsed = this._parsedMap.get(nameProperty);\n\n    if (!parsed) {\n      var rawRegions = this._parseToRegions(nameProperty);\n\n      parsed = this._parsedMap.set(nameProperty, {\n        regions: rawRegions,\n        boundingRect: calculateBoundingRect(rawRegions)\n      });\n    }\n\n    var regionsMap = createHashMap();\n    var finalRegions = [];\n    each(parsed.regions, function (region) {\n      var regionName = region.name; // Try use the alias in geoNameMap\n\n      if (nameMap && nameMap.hasOwnProperty(regionName)) {\n        region = region.cloneShallow(regionName = nameMap[regionName]);\n      }\n\n      finalRegions.push(region);\n      regionsMap.set(regionName, region);\n    });\n    return {\n      regions: finalRegions,\n      boundingRect: parsed.boundingRect || new BoundingRect(0, 0, 0, 0),\n      regionsMap: regionsMap\n    };\n  };\n\n  GeoJSONResource.prototype._parseToRegions = function (nameProperty) {\n    var mapName = this._mapName;\n    var geoJSON = this._geoJSON;\n    var rawRegions; // https://jsperf.com/try-catch-performance-overhead\n\n    try {\n      rawRegions = geoJSON ? parseGeoJson(geoJSON, nameProperty) : [];\n    } catch (e) {\n      throw new Error('Invalid geoJson format\\n' + e.message);\n    }\n\n    fixNanhai(mapName, rawRegions);\n    each(rawRegions, function (region) {\n      var regionName = region.name;\n      fixTextCoord(mapName, region);\n      fixGeoCoord(mapName, region);\n      fixDiaoyuIsland(mapName, region); // Some area like Alaska in USA map needs to be tansformed\n      // to look better\n\n      var specialArea = this._specialAreas && this._specialAreas[regionName];\n\n      if (specialArea) {\n        region.transformTo(specialArea.left, specialArea.top, specialArea.width, specialArea.height);\n      }\n    }, this);\n    return rawRegions;\n  };\n  /**\n   * Only for exporting to users.\n   * **MUST NOT** used internally.\n   */\n\n\n  GeoJSONResource.prototype.getMapForUser = function () {\n    return {\n      // For backward compatibility, use geoJson\n      // PENDING: it has been returning them without clone.\n      // do we need to avoid outsite modification?\n      geoJson: this._geoJSON,\n      geoJSON: this._geoJSON,\n      specialAreas: this._specialAreas\n    };\n  };\n\n  return GeoJSONResource;\n}();\n\nexport { GeoJSONResource };\n\nfunction calculateBoundingRect(regions) {\n  var rect;\n\n  for (var i = 0; i < regions.length; i++) {\n    var regionRect = regions[i].getBoundingRect();\n    rect = rect || regionRect.clone();\n    rect.union(regionRect);\n  }\n\n  return rect;\n}\n\nfunction parseInput(source) {\n  return !isString(source) ? source : typeof JSON !== 'undefined' && JSON.parse ? JSON.parse(source) : new Function('return (' + source + ');')();\n}","map":{"version":3,"names":["each","isString","createHashMap","parseGeoJson","fixNanhai","fixTextCoord","fixGeoCoord","fixDiaoyuIsland","BoundingRect","DEFAULT_NAME_PROPERTY","GeoJSONResource","mapName","geoJSON","specialAreas","type","_parsedMap","_mapName","_specialAreas","_geoJSON","parseInput","prototype","load","nameMap","nameProperty","parsed","get","rawRegions","_parseToRegions","set","regions","boundingRect","calculateBoundingRect","regionsMap","finalRegions","region","regionName","name","hasOwnProperty","cloneShallow","push","e","Error","message","specialArea","transformTo","left","top","width","height","getMapForUser","geoJson","rect","i","length","regionRect","getBoundingRect","clone","union","source","JSON","parse","Function"],"sources":["E:/school/qianduan/web/vue-manage/node_modules/echarts/lib/coord/geo/GeoJSONResource.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { each, isString, createHashMap } from 'zrender/lib/core/util';\nimport parseGeoJson from './parseGeoJson'; // Built-in GEO fixer.\n\nimport fixNanhai from './fix/nanhai';\nimport fixTextCoord from './fix/textCoord';\nimport fixGeoCoord from './fix/geoCoord';\nimport fixDiaoyuIsland from './fix/diaoyuIsland';\nimport BoundingRect from 'zrender/lib/core/BoundingRect';\nvar DEFAULT_NAME_PROPERTY = 'name';\n\nvar GeoJSONResource =\n/** @class */\nfunction () {\n  function GeoJSONResource(mapName, geoJSON, specialAreas) {\n    this.type = 'geoJSON';\n    this._parsedMap = createHashMap();\n    this._mapName = mapName;\n    this._specialAreas = specialAreas; // PENDING: delay the parse to the first usage to rapid up the FMP?\n\n    this._geoJSON = parseInput(geoJSON);\n  }\n  /**\n   * @param nameMap can be null/undefined\n   * @param nameProperty can be null/undefined\n   */\n\n\n  GeoJSONResource.prototype.load = function (nameMap, nameProperty) {\n    nameProperty = nameProperty || DEFAULT_NAME_PROPERTY;\n\n    var parsed = this._parsedMap.get(nameProperty);\n\n    if (!parsed) {\n      var rawRegions = this._parseToRegions(nameProperty);\n\n      parsed = this._parsedMap.set(nameProperty, {\n        regions: rawRegions,\n        boundingRect: calculateBoundingRect(rawRegions)\n      });\n    }\n\n    var regionsMap = createHashMap();\n    var finalRegions = [];\n    each(parsed.regions, function (region) {\n      var regionName = region.name; // Try use the alias in geoNameMap\n\n      if (nameMap && nameMap.hasOwnProperty(regionName)) {\n        region = region.cloneShallow(regionName = nameMap[regionName]);\n      }\n\n      finalRegions.push(region);\n      regionsMap.set(regionName, region);\n    });\n    return {\n      regions: finalRegions,\n      boundingRect: parsed.boundingRect || new BoundingRect(0, 0, 0, 0),\n      regionsMap: regionsMap\n    };\n  };\n\n  GeoJSONResource.prototype._parseToRegions = function (nameProperty) {\n    var mapName = this._mapName;\n    var geoJSON = this._geoJSON;\n    var rawRegions; // https://jsperf.com/try-catch-performance-overhead\n\n    try {\n      rawRegions = geoJSON ? parseGeoJson(geoJSON, nameProperty) : [];\n    } catch (e) {\n      throw new Error('Invalid geoJson format\\n' + e.message);\n    }\n\n    fixNanhai(mapName, rawRegions);\n    each(rawRegions, function (region) {\n      var regionName = region.name;\n      fixTextCoord(mapName, region);\n      fixGeoCoord(mapName, region);\n      fixDiaoyuIsland(mapName, region); // Some area like Alaska in USA map needs to be tansformed\n      // to look better\n\n      var specialArea = this._specialAreas && this._specialAreas[regionName];\n\n      if (specialArea) {\n        region.transformTo(specialArea.left, specialArea.top, specialArea.width, specialArea.height);\n      }\n    }, this);\n    return rawRegions;\n  };\n  /**\n   * Only for exporting to users.\n   * **MUST NOT** used internally.\n   */\n\n\n  GeoJSONResource.prototype.getMapForUser = function () {\n    return {\n      // For backward compatibility, use geoJson\n      // PENDING: it has been returning them without clone.\n      // do we need to avoid outsite modification?\n      geoJson: this._geoJSON,\n      geoJSON: this._geoJSON,\n      specialAreas: this._specialAreas\n    };\n  };\n\n  return GeoJSONResource;\n}();\n\nexport { GeoJSONResource };\n\nfunction calculateBoundingRect(regions) {\n  var rect;\n\n  for (var i = 0; i < regions.length; i++) {\n    var regionRect = regions[i].getBoundingRect();\n    rect = rect || regionRect.clone();\n    rect.union(regionRect);\n  }\n\n  return rect;\n}\n\nfunction parseInput(source) {\n  return !isString(source) ? source : typeof JSON !== 'undefined' && JSON.parse ? JSON.parse(source) : new Function('return (' + source + ');')();\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}